vocab mlatu {

  intrinsic draw (List[List[RGBA]] -> +IO)

}

type RGBA:
  case rgba (UInt8, UInt8, UInt8, UInt8)

define draw (List[List[RGBA]] -> +IO):
  _::mlatu::draw

define circle (Int32 -> List[List[RGBA]]):
  -> r;
  0u8 0u8 0u8 0u8 rgba
  (2 * r + 1) replicate
  (2 * r + 1) replicate
  do (map_index) -> row, y:
    row do (map_index) -> pixel, x:
      x - r -> dx;
      y - r -> dy;
      if (dx * dx + dy * dy - r * r <= 0):
        255u8 0u8 0u8 255u8 rgba
      else:
        pixel
